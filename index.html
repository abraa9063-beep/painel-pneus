<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Transportes Canarinho - Controle de Pneus</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #0f172a;
      --panel: #111827;
      --panel-light: #1f2937;
      --accent: #38bdf8;
      --accent-soft: rgba(56, 189, 248, 0.1);
      --text: #e2e8f0;
      --muted: #94a3b8;
      --danger: #f43f5e;
      --warn: #f97316;
      --success: #10b981;
      --radius: 14px;
    }
    * {
      box-sizing: border-box;
      font-family: "Segoe UI", system-ui, -apple-system, BlinkMacSystemFont, "Inter", sans-serif;
    }
    body {
      margin: 0;
      background: radial-gradient(circle at top, rgba(31, 41, 55, 0.95), #020617);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      font-size: 15px;
      position: relative;
      overflow-x: hidden;
    }
    /* LOGO DE FUNDO GRANDE */
    body::before {
      content: "";
      position: fixed;
      inset: 0;
      background:
        radial-gradient(circle at center, rgba(2, 6, 23, 0) 0%, rgba(2, 6, 23, 0.65) 60%, #020617 100%),
        url("Logo Nova_page-0001 (1).png") no-repeat center center;
      background-size: 900px auto;
      opacity: 0.12;
      pointer-events: none;
      z-index: -1;
    }

    header {
      padding: 16px 24px;
      border-bottom: 1px solid rgba(148, 163, 184, 0.12);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      background: rgba(2, 6, 23, 0.78);
      backdrop-filter: blur(16px);
    }
    header h1 {
      font-size: 1.2rem;
      margin: 0;
      display: flex;
      align-items: center;
      gap: 10px;
      white-space: nowrap;
    }
    .logo-icon {
      height: 38px;
      width: 38px;
      border-radius: 999px;
      object-fit: cover;
      object-position: left center;
      background: #020617;
    }
    .tag {
      background: rgba(56, 189, 248, 0.12);
      border: 1px solid rgba(56, 189, 248, 0.4);
      padding: 3px 12px;
      border-radius: 999px;
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.06em;
    }
    main {
      padding: 20px 24px 40px;
      max-width: 1400px;
      width: 100%;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: 18px;
    }
    .toolbar {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
    }
    .input, select, textarea {
      background: rgba(15, 23, 42, 0.6);
      border: 1px solid rgba(148, 163, 184, 0.2);
      border-radius: 999px;
      padding: 8px 14px 8px 32px;
      color: var(--text);
      font-size: 0.85rem;
      position: relative;
      outline: none;
    }
    textarea {
      border-radius: 12px;
      min-height: 60px;
      resize: vertical;
    }
    .input-wrapper { position: relative; }
    .input-icon {
      position: absolute;
      left: 10px;
      top: 7px;
      font-size: 0.85rem;
      color: var(--muted);
    }
    .btn {
      background: linear-gradient(120deg, #38bdf8, #0ea5e9);
      color: #020617;
      border: none;
      border-radius: 999px;
      padding: 8px 16px;
      font-weight: 600;
      font-size: 0.78rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: transform 0.08s ease-out;
    }
    .btn:active { transform: translateY(1px); }
    .card {
      background: rgba(2, 6, 23, 0.55);
      border: 1px solid rgba(148, 163, 184, 0.06);
      border-radius: var(--radius);
      overflow: hidden;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      min-width: 600px;
    }
    thead { background: rgba(15, 23, 42, 0.42); }
    th, td {
      text-align: left;
      padding: 10px 14px;
      font-size: 0.8rem;
    }
    th {
      color: var(--muted);
      font-weight: 600;
      cursor: pointer;
      user-select: none;
      white-space: nowrap;
    }
    tbody tr {
      border-bottom: 1px solid rgba(148, 163, 184, 0.06);
      transition: background 0.1s ease-out;
    }
    tbody tr:hover { background: rgba(15, 23, 42, 0.3); }
    .badge {
      background: rgba(15, 23, 42, 0.6);
      border: 1px solid rgba(148, 163, 184, 0.15);
      border-radius: 999px;
      padding: 2px 10px;
      font-size: 0.7rem;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }
    .qty-low {
      background: rgba(244, 63, 94, 0.12);
      color: #ffe4e6;
      border-color: rgba(244, 63, 94, 0.4);
    }
    .sulco-critico {
      background: rgba(244, 63, 94, 0.2);
      color: #ffe4e6;
      border-color: rgba(244, 63, 94, 0.6);
    }
    .sulco-alerta {
      background: rgba(249, 115, 22, 0.15);
      color: #ffedd5;
      border-color: rgba(249, 115, 22, 0.5);
    }
    .sulco-ok {
      background: rgba(16, 185, 129, 0.15);
      color: #d1fae5;
      border-color: rgba(16, 185, 129, 0.4);
    }
    .actions { display: flex; gap: 6px; flex-wrap: wrap; }
    .btn-xs {
      background: rgba(15, 23, 42, 0.4);
      border: 1px solid rgba(148, 163, 184, 0.12);
      color: var(--text);
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 0.7rem;
      cursor: pointer;
    }
    .btn-danger {
      background: rgba(244, 63, 94, 0.1);
      border: 1px solid rgba(244, 63, 94, 0.3);
      color: #ffe4e6;
    }
    .btn-success {
      background: rgba(16, 185, 129, 0.1);
      border: 1px solid rgba(16, 185, 129, 0.3);
      color: #d1fae5;
    }
    .list-wrapper { overflow-x: auto; }
    .section-title {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }
    .small { font-size: 0.7rem; color: var(--muted); }

    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(2, 6, 23, 0.6);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 99;
    }
    .modal {
      background: #0f172a;
      border: 1px solid rgba(148, 163, 184, 0.2);
      border-radius: 16px;
      padding: 18px;
      min-width: 280px;
      max-width: 500px;
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .modal h2 { font-size: 1rem; margin: 0; }
    .modal label { font-size: 0.72rem; color: var(--muted); margin-bottom: 3px; }
    .modal input, .modal select, .modal textarea {
      width: 100%;
      border-radius: 8px;
      background: rgba(15, 23, 42, 0.3);
      padding: 6px 8px;
      border: 1px solid rgba(148, 163, 184, 0.15);
      color: var(--text);
    }
    .modal-actions { display: flex; justify-content: flex-end; gap: 8px; margin-top: 6px; }

    .tabs { display: flex; gap: 8px; margin-top: 8px; flex-wrap: wrap; }
    .tab-btn {
      background: rgba(15, 23, 42, 0.2);
      border: 1px solid transparent;
      color: var(--muted);
      padding: 6px 14px;
      border-radius: 999px;
      font-size: 0.72rem;
      cursor: pointer;
    }
    .tab-btn.active {
      background: rgba(56, 189, 248, 0.12);
      border-color: rgba(56, 189, 248, 0.3);
      color: var(--text);
    }
    .hidden { display: none; }

    .img-thumb {
      width: 38px;
      height: 38px;
      object-fit: cover;
      border-radius: 8px;
      border: 1px solid rgba(148, 163, 184, 0.2);
      background: rgba(148, 163, 184, 0.05);
      cursor: pointer;
    }

    #photoModal .modal {
      max-width: 520px;
      align-items: center;
    }
    #photoModal img {
      max-width: 480px;
      max-height: 480px;
      border-radius: 12px;
    }

    .alert-banner {
      background: rgba(249, 115, 22, 0.15);
      border: 1px solid rgba(249, 115, 22, 0.3);
      border-radius: 8px;
      padding: 10px 14px;
      margin-bottom: 15px;
    }
    .alert-banner.critical {
      background: rgba(244, 63, 94, 0.15);
      border-color: rgba(244, 63, 94, 0.3);
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 12px;
      margin-bottom: 15px;
    }
    .stat-card {
      background: rgba(15, 23, 42, 0.3);
      border-radius: 12px;
      padding: 12px;
      border: 1px solid rgba(148, 163, 184, 0.1);
    }
    .stat-value {
      font-size: 1.4rem;
      font-weight: bold;
      color: var(--accent);
    }
    .stat-label {
      font-size: 0.7rem;
      color: var(--muted);
    }

    @media (max-width: 720px) {
      header { flex-direction: column; align-items: flex-start; }
      .toolbar { flex-direction: column; align-items: stretch; }
      .input, select { width: 100%; }
      body::before { background-size: 620px auto; }
      .stats-grid { grid-template-columns: 1fr; }
    }

    .field-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
  </style>
</head>
<body>
  <header>
    <div>
      <h1>
        <img src="Logo Nova_page-0001 (1).png" alt="Transportes Canarinho" class="logo-icon" />
        Transportes Canarinho - Controle de Pneus
      </h1>
      <div class="small">Sistema especializado em gest√£o de pneus</div>
    </div>
    <span class="tag" id="saveStatus">autosave ativo</span>
  </header>
  <main>
    <div class="tabs">
      <button class="tab-btn active" data-tab="estoque">Estoque de Pneus</button>
      <button class="tab-btn" data-tab="saidas">Sa√≠das</button>
      <button class="tab-btn" data-tab="pneus-uso">Pneus em Uso</button>
      <button class="tab-btn" data-tab="alertas">Alertas</button>
    </div>

    <!-- ALERTAS -->
    <div id="tab-alertas" class="hidden">
      <div class="card">
        <div class="section-title" style="padding: 14px 14px 0;">
          <div>
            <strong>Alertas do Sistema</strong>
            <div class="small">Monitoramento de pneus com aten√ß√£o necess√°ria</div>
          </div>
        </div>
        <div style="padding: 14px;" id="alertsContainer">
          <!-- Alertas ser√£o gerados dinamicamente -->
        </div>
      </div>
    </div>

    <!-- ESTOQUE -->
    <div id="tab-estoque">
      <div class="stats-grid" id="statsContainer">
        <!-- Estat√≠sticas ser√£o geradas dinamicamente -->
      </div>

      <div class="toolbar">
        <div class="input-wrapper">
          <span class="input-icon">üîç</span>
          <input id="searchInput" class="input" type="text" placeholder="Buscar por ID, medida, DOT..." />
        </div>
        <div class="input-wrapper">
          <span class="input-icon">üóÇ</span>
          <select id="statusFilter" class="input" style="padding-left:30px;">
            <option value="">Todos os status</option>
            <option value="Novo">Novo</option>
            <option value="Usado">Usado</option>
            <option value="Reformado">Reformado</option>
          </select>
        </div>
        <button id="addItemBtn" class="btn">+ Novo Pneu</button>
      </div>

      <div class="card" style="margin-top:10px;">
        <div class="section-title" style="padding: 10px 14px 0;">
          <div>
            <strong>Estoque de Pneus</strong>
            <div class="small" id="itemsCount"></div>
          </div>
        </div>
        <div class="list-wrapper">
          <table>
            <thead>
              <tr>
                <th data-sort="id">ID</th>
                <th data-sort="medida">Medida</th>
                <th data-sort="marca">Marca</th>
                <th data-sort="dot">DOT</th>
                <th data-sort="sulco">Sulco (mm)</th>
                <th data-sort="status">Status</th>
                <th data-sort="qty">Qtd.</th>
                <th style="width: 200px;">A√ß√µes</th>
              </tr>
            </thead>
            <tbody id="tableBody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- SA√çDAS -->
    <div id="tab-saidas" class="hidden">
      <div class="toolbar" style="margin-bottom:6px;">
        <div class="input-wrapper">
          <span class="input-icon">üöõ</span>
          <input id="filterPlaca" class="input" type="text" placeholder="Filtrar por placa (ex: ABC1D23)" />
        </div>
        <div class="input-wrapper">
          <span class="input-icon">üîß</span>
          <input id="filterPeca" class="input" type="text" placeholder="Filtrar por medida ou DOT" />
        </div>
      </div>
      <div class="card">
        <div class="section-title" style="padding: 10px 14px 0;">
          <div>
            <strong>Hist√≥rico de Sa√≠das</strong>
            <div class="small">Registro de todas as movimenta√ß√µes de pneus</div>
          </div>
        </div>
        <div class="list-wrapper">
          <table>
            <thead>
              <tr>
                <th>Data</th>
                <th>Pneu</th>
                <th>Medida</th>
                <th>Qtd.</th>
                <th>Ve√≠culo/Placa</th>
                <th>Posi√ß√£o</th>
                <th>Motorista</th>
                <th>KM</th>
              </tr>
            </thead>
            <tbody id="movementsBody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- PNEUS EM USO -->
    <div id="tab-pneus-uso" class="hidden">
      <div class="toolbar" style="margin-bottom:6px;">
        <div class="input-wrapper">
          <span class="input-icon">üöõ</span>
          <input id="filterUsoPlaca" class="input" type="text" placeholder="Filtrar por placa..." />
        </div>
      </div>
      <div class="card">
        <div class="section-title" style="padding: 10px 14px 0;">
          <div>
            <strong>Pneus em Uso</strong>
            <div class="small">Pneus atualmente instalados em ve√≠culos</div>
          </div>
        </div>
        <div class="list-wrapper">
          <table>
            <thead>
              <tr>
                <th>Placa</th>
                <th>Pneu</th>
                <th>Medida</th>
                <th>Posi√ß√£o</th>
                <th>Data Instala√ß√£o</th>
                <th>KM Instala√ß√£o</th>
                <th>Motorista</th>
                <th>A√ß√µes</th>
              </tr>
            </thead>
            <tbody id="pneusEmUsoBody"></tbody>
          </table>
        </div>
      </div>
    </div>
  </main>

  <!-- Modal Sa√≠da Espec√≠fica para Pneus -->
  <div class="modal-backdrop" id="pneuSaidaModal">
    <div class="modal">
      <h2>Sa√≠da de Pneu</h2>
      <div class="small" id="pneuSaidaLabel"></div>
      
      <label for="saidaPlaca">Ve√≠culo/Placa *</label>
      <input id="saidaPlaca" type="text" placeholder="ABC1D23" required />
      
      <label for="saidaPosicao">Posi√ß√£o no ve√≠culo *</label>
      <select id="saidaPosicao">
        <option value="">Selecionar posi√ß√£o</option>
        <option value="Dianteira Esquerda">Dianteira Esquerda</option>
        <option value="Dianteira Direita">Dianteira Direita</option>
        <option value="Traseira Externa Esq">Traseira Externa Esq</option>
        <option value="Traseira Externa Dir">Traseira Externa Dir</option>
        <option value="Traseira Interna Esq">Traseira Interna Esq</option>
        <option value="Traseira Interna Dir">Traseira Interna Dir</option>
        <option value="Step">Step (Soco)</option>
      </select>

      <div class="field-row">
        <div>
          <label for="saidaMotorista">Motorista</label>
          <input id="saidaMotorista" type="text" />
        </div>
        <div>
          <label for="saidaKm">KM do Ve√≠culo</label>
          <input id="saidaKm" type="number" />
        </div>
      </div>

      <label for="saidaObs">Observa√ß√£o</label>
      <textarea id="saidaObs" placeholder="Motivo da troca, condi√ß√µes do pneu..."></textarea>

      <div class="modal-actions">
        <button class="btn-xs" onclick="closePneuSaidaModal()">Cancelar</button>
        <button class="btn" onclick="confirmPneuSaida()">Confirmar Sa√≠da</button>
      </div>
    </div>
  </div>

  <!-- Modal Ajuste -->
  <div class="modal-backdrop" id="adjustModal">
    <div class="modal">
      <h2>Ajustar estoque</h2>
      <div class="small" id="adjustItemLabel"></div>
      <label for="adjustType">Tipo de ajuste</label>
      <select id="adjustType">
        <option value="in">Entrada (+)</option>
        <option value="out">Sa√≠da (-)</option>
      </select>
      <label for="adjustAmount">Quantidade</label>
      <input id="adjustAmount" type="number" min="1" value="1" />
      <div class="modal-actions">
        <button class="btn-xs" onclick="closeAdjustModal()">Cancelar</button>
        <button class="btn" onclick="confirmAdjust()">Confirmar</button>
      </div>
    </div>
  </div>

  <!-- Modal Editar/Adicionar Pneu -->
  <div class="modal-backdrop" id="editModal">
    <div class="modal">
      <h2 id="editTitle">Novo Pneu</h2>
      
      <div class="field-row">
        <div>
          <label for="editId">ID *</label>
          <input id="editId" type="text" />
        </div>
        <div>
          <label for="editMedida">Medida *</label>
          <input id="editMedida" type="text" placeholder="295/80 R22.5" />
        </div>
      </div>

      <div class="field-row">
        <div>
          <label for="editMarca">Marca</label>
          <input id="editMarca" type="text" />
        </div>
        <div>
          <label for="editModelo">Modelo</label>
          <input id="editModelo" type="text" />
        </div>
      </div>

      <div class="field-row">
        <div>
          <label for="editDot">DOT</label>
          <input id="editDot" type="text" placeholder="4321" />
        </div>
        <div>
          <label for="editSulco">Sulco (mm)</label>
          <input id="editSulco" type="number" step="0.1" min="0" max="20" />
        </div>
      </div>

      <div class="field-row">
        <div>
          <label for="editStatus">Status</label>
          <select id="editStatus">
            <option value="Novo">Novo</option>
            <option value="Usado">Usado</option>
            <option value="Reformado">Reformado</option>
          </select>
        </div>
        <div>
          <label for="editPosicao">Posi√ß√£o</label>
          <select id="editPosicao">
            <option value="Direcional">Direcional</option>
            <option value="Tra√ß√£o">Tra√ß√£o</option>
            <option value="Rebocado">Rebocado</option>
            <option value="Livre">Livre</option>
          </select>
        </div>
      </div>

      <div class="field-row">
        <div>
          <label for="editQty">Quantidade *</label>
          <input id="editQty" type="number" min="0" />
        </div>
        <div>
          <label for="editReorder">Ponto de reposi√ß√£o</label>
          <input id="editReorder" type="number" min="0" value="2" />
        </div>
      </div>

      <label for="editIndiceCarga">√çndice de Carga/Velocidade</label>
      <input id="editIndiceCarga" type="text" placeholder="152/148 L" />

      <label for="editPhoto">Foto do pneu (opcional)</label>
      <input id="editPhoto" type="file" accept="image/*" />
      <img id="photoPreview" alt="Pr√©via" style="width:64px;height:64px;object-fit:cover;border-radius:8px;border:1px solid rgba(148,163,184,0.2);display:none;" />

      <div class="modal-actions">
        <button class="btn-xs" onclick="closeEditModal()">Cancelar</button>
        <button class="btn" onclick="saveItem()">Salvar</button>
      </div>
    </div>
  </div>

  <!-- Modal Foto -->
  <div class="modal-backdrop" id="photoModal">
    <div class="modal">
      <h2>Foto do Pneu</h2>
      <img id="photoModalImg" src="" alt="Foto do pneu" />
      <div class="modal-actions">
        <button class="btn" onclick="closePhotoModal()">Fechar</button>
      </div>
    </div>
  </div>

  <script>
    const STORAGE_KEY_ITEMS = "tc_pneus_items_v2";
    const STORAGE_KEY_MOVES = "tc_pneus_moves_v2";
    const STORAGE_KEY_EM_USO = "tc_pneus_em_uso_v2";

    let items = loadItems();
    let movements = loadMovements();
    let pneusEmUso = loadPneusEmUso();

    let currentSort = { key: "medida", dir: "asc" };
    let filtered = [...items];
    let adjustTarget = null;
    let editTarget = null;
    let tempPhotoData = null;
    let saidaTarget = null;

    // Inicializa√ß√£o
    const tableBody = document.getElementById("tableBody");
    const itemsCount = document.getElementById("itemsCount");
    const searchInput = document.getElementById("searchInput");
    const statusFilter = document.getElementById("statusFilter");
    const saveStatus = document.getElementById("saveStatus");
    const filterPlacaInput = document.getElementById("filterPlaca");
    const filterPecaInput = document.getElementById("filterPeca");
    const filterUsoPlacaInput = document.getElementById("filterUsoPlaca");

    function loadItems() {
      const raw = localStorage.getItem(STORAGE_KEY_ITEMS);
      if (raw) {
        try { return JSON.parse(raw); } catch(e) {}
      }
      // Dados de exemplo para pneus
      return [
        { 
          id: "PNEU-001", 
          name: "Pneu 295/80 R22.5", 
          medida: "295/80 R22.5",
          marca: "Michelin",
          modelo: "X Line Energy",
          dot: "4321",
          sulco: 8.5,
          status: "Novo",
          posicao: "Direcional",
          indiceCarga: "152/148 L",
          category: "Pneus", 
          qty: 8, 
          reorderPoint: 2,
          photo: "" 
        },
        { 
          id: "PNEU-002", 
          name: "Pneu 11R22.5", 
          medida: "11R22.5",
          marca: "Bridgestone",
          modelo: "R194",
          dot: "1234",
          sulco: 4.2,
          status: "Usado",
          posicao: "Tra√ß√£o",
          indiceCarga: "148/145 L",
          category: "Pneus", 
          qty: 3, 
          reorderPoint: 2,
          photo: "" 
        },
        { 
          id: "PNEU-003", 
          name: "Pneu 385/65 R22.5", 
          medida: "385/65 R22.5",
          marca: "Goodyear",
          modelo: "Fuel Max",
          dot: "5678",
          sulco: 2.8,
          status: "Reformado",
          posicao: "Rebocado",
          indiceCarga: "160/158 M",
          category: "Pneus", 
          qty: 5, 
          reorderPoint: 2,
          photo: "" 
        }
      ];
    }

    function loadMovements() {
      const raw = localStorage.getItem(STORAGE_KEY_MOVES);
      if (raw) {
        try { return JSON.parse(raw); } catch(e) {}
      }
      return [];
    }

    function loadPneusEmUso() {
      const raw = localStorage.getItem(STORAGE_KEY_EM_USO);
      if (raw) {
        try { return JSON.parse(raw); } catch(e) {}
      }
      return [];
    }

    function saveAll() {
      localStorage.setItem(STORAGE_KEY_ITEMS, JSON.stringify(items));
      localStorage.setItem(STORAGE_KEY_MOVES, JSON.stringify(movements));
      localStorage.setItem(STORAGE_KEY_EM_USO, JSON.stringify(pneusEmUso));
      if (saveStatus) {
        saveStatus.textContent = "salvo ‚úî";
        setTimeout(() => saveStatus.textContent = "autosave ativo", 1500);
      }
    }

    function renderStats() {
      const totalPneus = items.reduce((sum, item) => sum + item.qty, 0);
      const pneusNovos = items.filter(item => item.status === "Novo").reduce((sum, item) => sum + item.qty, 0);
      const pneusBaixoEstoque = items.filter(item => item.qty <= item.reorderPoint).reduce((sum, item) => sum + item.qty, 0);
      const pneusSulcoCritico = items.filter(item => item.sulco < 3.0).reduce((sum, item) => sum + item.qty, 0);

      document.getElementById('statsContainer').innerHTML = `
        <div class="stat-card">
          <div class="stat-value">${totalPneus}</div>
          <div class="stat-label">Total em Estoque</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">${pneusNovos}</div>
          <div class="stat-label">Pneus Novos</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">${pneusBaixoEstoque}</div>
          <div class="stat-label">Baixo Estoque</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">${pneusSulcoCritico}</div>
          <div class="stat-label">Sulco Cr√≠tico</div>
        </div>
      `;
    }

    function renderAlerts() {
      const alerts = checkAlerts();
      const container = document.getElementById('alertsContainer');
      
      if (alerts.length === 0) {
        container.innerHTML = '<div class="alert-banner">‚úÖ Todos os pneus est√£o em condi√ß√µes normais</div>';
        return;
      }

      container.innerHTML = alerts.map(alert => `
        <div class="alert-banner ${alert.type === 'CRITICO' ? 'critical' : ''}">
          <strong>${alert.type === 'CRITICO' ? 'üö® CR√çTICO' : '‚ö†Ô∏è ALERTA'}:</strong> ${alert.message}
        </div>
      `).join('');
    }

    function checkAlerts() {
      const alerts = [];
      
      items.forEach(pneu => {
        // Alertas de sulco
        if (pneu.sulco < 2.0) {
          alerts.push({
            type: "CRITICO",
            message: `${pneu.id} - Sulco extremamente baixo: ${pneu.sulco}mm (TROCA URGENTE)`
          });
        } else if (pneu.sulco < 3.0) {
          alerts.push({
            type: "CRITICO", 
            message: `${pneu.id} - Sulco cr√≠tico: ${pneu.sulco}mm`
          });
        } else if (pneu.sulco < 5.0) {
          alerts.push({
            type: "ALERTA",
            message: `${pneu.id} - Sulco baixo: ${pneu.sulco}mm`
          });
        }

        // Alertas de estoque
        if (pneu.qty <= pneu.reorderPoint) {
          alerts.push({
            type: "ALERTA",
            message: `${pneu.id} - Estoque baixo: ${pneu.qty} unidade(s)`
          });
        }

        // Alertas de DOT antigo (exemplo: mais de 5 anos)
        if (pneu.dot && parseInt(pneu.dot) < 2019) {
          alerts.push({
            type: "ALERTA",
            message: `${pneu.id} - DOT antigo: ${pneu.dot} (verificar validade)`
          });
        }
      });

      return alerts;
    }

    function renderTable() {
      tableBody.innerHTML = "";
      filtered.forEach((item) => {
        const needsReorder = item.qty <= item.reorderPoint;
        const sulcoClass = item.sulco < 3.0 ? "sulco-critico" : 
                          item.sulco < 5.0 ? "sulco-alerta" : "sulco-ok";
        
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td><strong>${item.id}</strong></td>
          <td>${item.medida}</td>
          <td>${item.marca || '-'}</td>
          <td>${item.dot || '-'}</td>
          <td><span class="badge ${sulcoClass}">${item.sulco}mm</span></td>
          <td><span class="badge">${item.status}</span></td>
          <td><span class="badge ${needsReorder ? "qty-low" : ""}">${item.qty} ${needsReorder ? "‚ö†" : ""}</span></td>
          <td>
            <div class="actions">
              <button class="btn-xs btn-success" onclick="openPneuSaidaModal('${item.id}')">Sa√≠da</button>
