<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Transportes Canarinho - Relat√≥rios Avan√ßados</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="theme-color" content="#0f172a" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  
  <!-- Chart.js para gr√°ficos -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <!-- SheetJS para Excel -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  
  <!-- jsPDF para PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  
  <style>
    :root {
      --bg: #0f172a;
      --panel: #111827;
      --accent: #38bdf8;
      --accent-dark: #0ea5e9;
      --text: #e2e8f0;
      --muted: #94a3b8;
      --danger: #f43f5e;
      --warn: #f97316;
      --success: #10b981;
      --purple: #8b5cf6;
      --radius: 12px;
      --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }
    
    * {
      box-sizing: border-box;
      font-family: "Segoe UI", system-ui, sans-serif;
      margin: 0;
      padding: 0;
      -webkit-tap-highlight-color: transparent;
    }
    
    body {
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      padding-bottom: 70px;
      overflow-x: hidden;
    }
    
    header {
      padding: 16px;
      border-bottom: 1px solid rgba(148, 163, 184, 0.12);
      background: rgba(2, 6, 23, 0.95);
      backdrop-filter: blur(10px);
      position: sticky;
      top: 0;
      z-index: 100;
    }
    
    header h1 {
      margin: 0;
      font-size: 1.2rem;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    /* Navega√ß√£o por tabs */
    .tabs-container {
      position: sticky;
      top: 60px;
      background: var(--bg);
      z-index: 90;
      padding: 10px 0;
      border-bottom: 1px solid rgba(148, 163, 184, 0.1);
    }
    
    .tabs-scroll {
      display: flex;
      overflow-x: auto;
      scrollbar-width: none;
      -ms-overflow-style: none;
      padding: 0 15px;
      gap: 8px;
    }
    
    .tabs-scroll::-webkit-scrollbar {
      display: none;
    }
    
    .tab-btn {
      background: rgba(15, 23, 42, 0.6);
      border: 1px solid rgba(148, 163, 184, 0.2);
      color: var(--text);
      padding: 12px 20px;
      border-radius: var(--radius);
      cursor: pointer;
      transition: all 0.3s ease;
      white-space: nowrap;
      flex-shrink: 0;
      font-size: 0.9rem;
      font-weight: 500;
    }
    
    .tab-btn.active {
      background: linear-gradient(135deg, var(--accent), var(--accent-dark));
      color: white;
      border-color: var(--accent);
      box-shadow: var(--shadow);
    }
    
    .hidden {
      display: none !important;
    }
    
    /* Layout principal de relat√≥rios */
    .reports-container {
      padding: 20px;
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .report-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
      flex-wrap: wrap;
      gap: 15px;
    }
    
    .report-title {
      font-size: 1.8rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--accent), var(--purple));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .controls-row {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }
    
    .date-range {
      display: flex;
      gap: 10px;
      align-items: center;
      background: rgba(15, 23, 42, 0.6);
      padding: 12px 16px;
      border-radius: var(--radius);
      border: 1px solid rgba(148, 163, 184, 0.2);
    }
    
    .input, select, button {
      padding: 12px 16px;
      border-radius: var(--radius);
      border: 1px solid rgba(148, 163, 184, 0.3);
      background: rgba(15, 23, 42, 0.8);
      color: var(--text);
      font-size: 0.95rem;
      transition: all 0.3s ease;
    }
    
    .input:focus, select:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(56, 189, 248, 0.1);
    }
    
    button {
      background: linear-gradient(135deg, var(--accent), var(--accent-dark));
      color: white;
      border: none;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      box-shadow: var(--shadow);
    }
    
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
    }
    
    .btn-success {
      background: linear-gradient(135deg, var(--success), #059669);
    }
    
    .btn-warning {
      background: linear-gradient(135deg, var(--warn), #ea580c);
    }
    
    .btn-danger {
      background: linear-gradient(135deg, var(--danger), #dc2626);
    }
    
    .btn-purple {
      background: linear-gradient(135deg, var(--purple), #7c3aed);
    }
    
    .btn-xs {
      padding: 8px 12px;
      font-size: 0.8rem;
      background: rgba(15, 23, 42, 0.4);
      color: var(--text);
      border: 1px solid rgba(148, 163, 184, 0.2);
      border-radius: 6px;
      cursor: pointer;
    }
    
    /* Cards de m√©tricas */
    .metrics-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .metric-card {
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.8), rgba(30, 41, 59, 0.6));
      padding: 25px;
      border-radius: var(--radius);
      border: 1px solid rgba(148, 163, 184, 0.1);
      backdrop-filter: blur(10px);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    
    .metric-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--accent), var(--purple));
    }
    
    .metric-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    }
    
    .metric-value {
      font-size: 2.5rem;
      font-weight: 800;
      margin-bottom: 8px;
      background: linear-gradient(135deg, var(--text), var(--muted));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .metric-label {
      color: var(--muted);
      font-size: 0.9rem;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .metric-change {
      font-size: 0.8rem;
      margin-top: 8px;
      display: flex;
      align-items: center;
      gap: 4px;
    }
    
    .positive {
      color: var(--success);
    }
    
    .negative {
      color: var(--danger);
    }
    
    /* Grid de gr√°ficos */
    .charts-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 25px;
      margin-bottom: 30px;
    }
    
    .chart-card {
      background: rgba(15, 23, 42, 0.6);
      border: 1px solid rgba(148, 163, 184, 0.1);
      border-radius: var(--radius);
      padding: 25px;
      backdrop-filter: blur(10px);
    }
    
    .chart-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    
    .chart-title {
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--text);
    }
    
    .chart-container {
      position: relative;
      height: 300px;
      width: 100%;
    }
    
    /* Tabelas de relat√≥rios */
    .table-card {
      background: rgba(15, 23, 42, 0.6);
      border: 1px solid rgba(148, 163, 184, 0.1);
      border-radius: var(--radius);
      overflow: hidden;
      backdrop-filter: blur(10px);
      margin-bottom: 25px;
    }
    
    .table-header {
      padding: 20px;
      border-bottom: 1px solid rgba(148, 163, 184, 0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .table-title {
      font-size: 1.3rem;
      font-weight: 600;
    }
    
    .table-container {
      overflow-x: auto;
    }
    
    .data-table {
      width: 100%;
      border-collapse: collapse;
    }
    
    .data-table th {
      background: rgba(30, 41, 59, 0.8);
      padding: 15px 12px;
      text-align: left;
      font-weight: 600;
      font-size: 0.85rem;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      border-bottom: 1px solid rgba(148, 163, 184, 0.1);
    }
    
    .data-table td {
      padding: 15px 12px;
      border-bottom: 1px solid rgba(148, 163, 184, 0.05);
      font-size: 0.9rem;
    }
    
    .data-table tr:hover {
      background: rgba(56, 189, 248, 0.05);
    }
    
    .status-badge {
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .status-novo { background: rgba(16, 185, 129, 0.2); color: #10b981; }
    .status-usado { background: rgba(249, 115, 22, 0.2); color: #f97316; }
    .status-reformado { background: rgba(139, 92, 246, 0.2); color: #8b5cf6; }
    .status-alta { background: rgba(244, 63, 94, 0.2); color: #f43f5e; }
    .status-media { background: rgba(249, 115, 22, 0.2); color: #f97316; }
    .status-baixa { background: rgba(16, 185, 129, 0.2); color: #10b981; }
    
    /* Cards de exporta√ß√£o */
    .export-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }
    
    .export-card {
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.8), rgba(30, 41, 59, 0.6));
      padding: 25px;
      border-radius: var(--radius);
      border: 1px solid rgba(148, 163, 184, 0.1);
      text-align: center;
      transition: all 0.3s ease;
      cursor: pointer;
    }
    
    .export-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
      border-color: var(--accent);
    }
    
    .export-icon {
      font-size: 3rem;
      margin-bottom: 15px;
    }
    
    .export-title {
      font-size: 1.2rem;
      font-weight: 600;
      margin-bottom: 10px;
    }
    
    .export-desc {
      color: var(--muted);
      font-size: 0.9rem;
      line-height: 1.5;
    }
    
    /* Barra de navega√ß√£o inferior */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(2, 6, 23, 0.95);
      backdrop-filter: blur(10px);
      border-top: 1px solid rgba(148, 163, 184, 0.1);
      display: flex;
      padding: 10px 15px;
      z-index: 99;
    }
    
    .nav-btn {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      background: none;
      border: none;
      color: var(--muted);
      padding: 8px 0;
      font-size: 0.7rem;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .nav-btn.active {
      color: var(--accent);
    }
    
    .nav-icon {
      font-size: 1.2rem;
    }
    
    /* Loading e estados vazios */
    .loading {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 40px;
      color: var(--muted);
    }
    
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: var(--muted);
    }
    
    .empty-state-icon {
      font-size: 4rem;
      margin-bottom: 20px;
      opacity: 0.5;
    }

    /* Notifica√ß√µes */
    .notification {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      padding: 12px 24px;
      border-radius: var(--radius);
      color: white;
      z-index: 1001;
      animation: slideIn 0.3s ease;
      text-align: center;
      min-width: 300px;
    }
    .notification.success { background: var(--success); }
    .notification.error { background: var(--danger); }
    .notification.warning { background: var(--warn); }
    @keyframes slideIn {
      from { transform: translateX(-50%) translateY(-100%); opacity: 0; }
      to { transform: translateX(-50%) translateY(0); opacity: 1; }
    }

    /* Modais */
    .modal-backdrop {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(2, 6, 23, 0.9);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      padding: 15px;
    }
    .modal {
      background: var(--bg);
      border: 1px solid rgba(148, 163, 184, 0.2);
      border-radius: var(--radius);
      padding: 20px;
      width: 100%;
      max-width: 600px;
      max-height: 90vh;
      overflow-y: auto;
    }
    .modal h2 {
      margin-top: 0;
      margin-bottom: 20px;
      font-size: 1.3rem;
    }
    .modal-actions {
      display: flex;
      gap: 10px;
      justify-content: flex-end;
      margin-top: 15px;
    }
    .field-row {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 10px;
    }
    .field-group {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }
    label {
      color: var(--muted);
      font-size: 0.9rem;
    }
    
    /* Responsividade */
    @media (max-width: 768px) {
      .charts-grid {
        grid-template-columns: 1fr;
      }
      
      .metrics-grid {
        grid-template-columns: 1fr;
      }
      
      .report-header {
        flex-direction: column;
        align-items: stretch;
      }
      
      .controls-row {
        justify-content: center;
      }
      
      .date-range {
        flex-direction: column;
      }
    }

    /* Estilos espec√≠ficos para fogos */
    .fogo-item {
      background: rgba(15, 23, 42, 0.6);
      border: 1px solid rgba(148, 163, 184, 0.1);
      border-radius: var(--radius);
      padding: 15px;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .fogo-info {
      flex: 1;
    }
    
    .fogo-number {
      font-size: 1.2rem;
      font-weight: bold;
      color: var(--accent);
    }
    
    .fogo-details {
      color: var(--muted);
      font-size: 0.9rem;
    }
    
    .fogo-actions {
      display: flex;
      gap: 8px;
    }

    /* Modal de sele√ß√£o de relat√≥rio */
    .report-options {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin: 20px 0;
    }
    
    .report-option {
      background: rgba(15, 23, 42, 0.6);
      border: 2px solid rgba(148, 163, 184, 0.2);
      border-radius: var(--radius);
      padding: 20px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .report-option:hover {
      border-color: var(--accent);
      transform: translateY(-2px);
    }
    
    .report-option.selected {
      border-color: var(--success);
      background: rgba(16, 185, 129, 0.1);
    }
    
    .report-option-icon {
      font-size: 2.5rem;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <!-- C√≥digo HTML anterior permanece igual -->
  <!-- ... -->

  <script>
    // ... C√≥digo JavaScript anterior ...

    // =============================================
    // FUN√á√ïES DE RELAT√ìRIOS COMPLETAS
    // =============================================

    function generateDashboardReport() {
      openReportModal('dashboard');
    }

    function exportComprehensiveReport() {
      generateComprehensivePDF();
    }

    function exportFinancialReport() {
      generateFinancialPDF();
    }

    function exportInventoryReport() {
      generateInventoryPDF();
    }

    function openReportModal(tipo) {
      const modal = document.createElement('div');
      modal.className = 'modal-backdrop';
      modal.style.display = 'flex';
      modal.innerHTML = `
        <div class="modal">
          <h2>Gerar Relat√≥rio - ${getReportTitle(tipo)}</h2>
          
          <div class="report-options">
            <div class="report-option" onclick="selectReportOption(this, 'pdf')">
              <div class="report-option-icon">üìä</div>
              <div class="export-title">Relat√≥rio PDF</div>
              <div class="export-desc">Relat√≥rio detalhado em PDF</div>
            </div>
            
            <div class="report-option" onclick="selectReportOption(this, 'excel')">
              <div class="report-option-icon">üìà</div>
              <div class="export-title">Planilha Excel</div>
              <div class="export-desc">Dados brutos em Excel</div>
            </div>
            
            <div class="report-option" onclick="selectReportOption(this, 'resumo')">
              <div class="report-option-icon">üìã</div>
              <div class="export-title">Relat√≥rio Resumido</div>
              <div class="export-desc">Vis√£o geral r√°pida</div>
            </div>
          </div>

          <div class="field-group">
            <label for="reportPeriod">Per√≠odo do Relat√≥rio</label>
            <select id="reportPeriod" class="input">
              <option value="hoje">Hoje</option>
              <option value="semana">Esta Semana</option>
              <option value="mes" selected>Este M√™s</option>
              <option value="trimestre">Este Trimestre</option>
              <option value="ano">Este Ano</option>
              <option value="personalizado">Personalizado</option>
            </select>
          </div>

          <div id="customDateRange" class="field-row hidden">
            <div class="field-group">
              <label for="customStartDate">Data Inicial</label>
              <input type="date" id="customStartDate" class="input">
            </div>
            <div class="field-group">
              <label for="customEndDate">Data Final</label>
              <input type="date" id="customEndDate" class="input">
            </div>
          </div>

          <div class="modal-actions">
            <button class="btn-xs" onclick="closeReportModal(this)">Cancelar</button>
            <button class="btn-success" onclick="generateSelectedReport('${tipo}')">Gerar Relat√≥rio</button>
          </div>
        </div>
      `;

      document.body.appendChild(modal);

      // Event listener para per√≠odo personalizado
      document.getElementById('reportPeriod').addEventListener('change', function() {
        const customRange = document.getElementById('customDateRange');
        customRange.classList.toggle('hidden', this.value !== 'personalizado');
      });
    }

    function getReportTitle(tipo) {
      const titles = {
        'dashboard': 'Dashboard Geral',
        'comprehensive': 'Relat√≥rio Completo',
        'financial': 'Relat√≥rio Financeiro',
        'inventory': 'Relat√≥rio de Estoque'
      };
      return titles[tipo] || 'Relat√≥rio';
    }

    function selectReportOption(element, tipo) {
      document.querySelectorAll('.report-option').forEach(opt => {
        opt.classList.remove('selected');
      });
      element.classList.add('selected');
      element.dataset.selectedType = tipo;
    }

    function closeReportModal(button) {
      const modal = button.closest('.modal-backdrop');
      modal.remove();
    }

    function generateSelectedReport(tipo) {
      const selectedOption = document.querySelector('.report-option.selected');
      if (!selectedOption) {
        showNotification('Selecione um tipo de relat√≥rio!', 'error');
        return;
      }

      const reportType = selectedOption.dataset.selectedType;
      const period = document.getElementById('reportPeriod').value;
      
      let startDate, endDate;
      
      if (period === 'personalizado') {
        startDate = document.getElementById('customStartDate').value;
        endDate = document.getElementById('customEndDate').value;
        if (!startDate || !endDate) {
          showNotification('Selecione as datas para o per√≠odo personalizado!', 'error');
          return;
        }
      } else {
        const dates = getDateRange(period);
        startDate = dates.startDate;
        endDate = dates.endDate;
      }

      // Fechar modal
      document.querySelector('.modal-backdrop').remove();

      // Gerar relat√≥rio baseado no tipo
      switch(reportType) {
        case 'pdf':
          generatePDFReport(tipo, startDate, endDate);
          break;
        case 'excel':
          generateExcelReport(tipo, startDate, endDate);
          break;
        case 'resumo':
          generateSummaryReport(tipo, startDate, endDate);
          break;
      }
    }

    function getDateRange(period) {
      const today = new Date();
      let startDate = new Date();
      let endDate = new Date();

      switch(period) {
        case 'hoje':
          startDate.setHours(0, 0, 0, 0);
          endDate.setHours(23, 59, 59, 999);
          break;
        case 'semana':
          startDate.setDate(today.getDate() - today.getDay());
          startDate.setHours(0, 0, 0, 0);
          endDate.setDate(today.getDate() + (6 - today.getDay()));
          endDate.setHours(23, 59, 59, 999);
          break;
        case 'mes':
          startDate = new Date(today.getFullYear(), today.getMonth(), 1);
          endDate = new Date(today.getFullYear(), today.getMonth() + 1, 0);
          endDate.setHours(23, 59, 59, 999);
          break;
        case 'trimestre':
          const quarter = Math.floor(today.getMonth() / 3);
          startDate = new Date(today.getFullYear(), quarter * 3, 1);
          endDate = new Date(today.getFullYear(), (quarter + 1) * 3, 0);
          endDate.setHours(23, 59, 59, 999);
          break;
        case 'ano':
          startDate = new Date(today.getFullYear(), 0, 1);
          endDate = new Date(today.getFullYear(), 11, 31);
          endDate.setHours(23, 59, 59, 999);
          break;
      }

      return {
        startDate: startDate.toISOString().split('T')[0],
        endDate: endDate.toISOString().split('T')[0]
      };
    }

    function generatePDFReport(tipo, startDate, endDate) {
      showNotification(`Gerando relat√≥rio PDF (${startDate} √† ${endDate})...`, 'success');
      
      // Simular gera√ß√£o de PDF (em produ√ß√£o, usaria jsPDF)
      setTimeout(() => {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        
        // Cabe√ßalho
        doc.setFontSize(20);
        doc.setTextColor(40, 40, 40);
        doc.text('TRANSPORTES CANARINHO', 105, 20, { align: 'center' });
        
        doc.setFontSize(16);
        doc.text(`Relat√≥rio ${getReportTitle(tipo)}`, 105, 35, { align: 'center' });
        
        doc.setFontSize(12);
        doc.text(`Per√≠odo: ${formatDate(startDate)} √† ${formatDate(endDate)}`, 105, 45, { align: 'center' });
        doc.text(`Gerado em: ${new Date().toLocaleDateString('pt-BR')}`, 105, 52, { align: 'center' });
        
        // Linha separadora
        doc.setDrawColor(200, 200, 200);
        doc.line(20, 60, 190, 60);
        
        // Conte√∫do do relat√≥rio baseado no tipo
        let yPosition = 75;
        
        switch(tipo) {
          case 'dashboard':
            addDashboardContent(doc, yPosition);
            break;
          case 'comprehensive':
            addComprehensiveContent(doc, yPosition);
            break;
          case 'financial':
            addFinancialContent(doc, yPosition);
            break;
          case 'inventory':
            addInventoryContent(doc, yPosition);
            break;
        }
        
        // Salvar PDF
        doc.save(`relatorio-${tipo}-${startDate}-${endDate}.pdf`);
        showNotification('Relat√≥rio PDF gerado com sucesso!', 'success');
      }, 2000);
    }

    function generateExcelReport(tipo, startDate, endDate) {
      showNotification(`Gerando planilha Excel (${startDate} √† ${endDate})...`, 'success');
      
      setTimeout(() => {
        let excelData = [];
        let fileName = '';
        
        switch(tipo) {
          case 'dashboard':
            excelData = generateDashboardExcelData();
            fileName = `dashboard-${startDate}-${endDate}.xlsx`;
            break;
          case 'comprehensive':
            excelData = generateComprehensiveExcelData();
            fileName = `relatorio-completo-${startDate}-${endDate}.xlsx`;
            break;
          case 'financial':
            excelData = generateFinancialExcelData();
            fileName = `relatorio-financeiro-${startDate}-${endDate}.xlsx`;
            break;
          case 'inventory':
            excelData = generateInventoryExcelData();
            fileName = `relatorio-estoque-${startDate}-${endDate}.xlsx`;
            break;
        }
        
        const ws = XLSX.utils.aoa_to_sheet(excelData);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Relat√≥rio");
        XLSX.writeFile(wb, fileName);
        
        showNotification('Planilha Excel gerada com sucesso!', 'success');
      }, 1500);
    }

    function generateSummaryReport(tipo, startDate, endDate) {
      showNotification(`Gerando relat√≥rio resumido (${startDate} √† ${endDate})...`, 'success');
      
      setTimeout(() => {
        // Criar uma nova janela/aba com o relat√≥rio resumido
        const reportWindow = window.open('', '_blank');
        const reportContent = generateSummaryContent(tipo, startDate, endDate);
        
        reportWindow.document.write(`
          <!DOCTYPE html>
          <html>
          <head>
            <title>Relat√≥rio Resumido - Transportes Canarinho</title>
            <style>
              body { font-family: Arial, sans-serif; margin: 40px; color: #333; }
              .header { text-align: center; border-bottom: 2px solid #2a5298; padding-bottom: 20px; margin-bottom: 30px; }
              .metric { background: #f8f9fa; padding: 15px; margin: 10px 0; border-radius: 8px; border-left: 4px solid #2a5298; }
              .positive { color: #28a745; }
              .negative { color: #dc3545; }
              table { width: 100%; border-collapse: collapse; margin: 20px 0; }
              th, td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
              th { background-color: #2a5298; color: white; }
            </style>
          </head>
          <body>
            ${reportContent}
          </body>
          </html>
        `);
        
        reportWindow.document.close();
        showNotification('Relat√≥rio resumido gerado com sucesso!', 'success');
      }, 1000);
    }

    // Fun√ß√µes auxiliares para conte√∫do dos relat√≥rios
    function formatDate(dateString) {
      return new Date(dateString).toLocaleDateString('pt-BR');
    }

    function addDashboardContent(doc, yPosition) {
      doc.setFontSize(14);
      doc.setTextColor(60, 60, 60);
      doc.text('RESUMO EXECUTIVO', 20, yPosition);
      
      yPosition += 15;
      doc.setFontSize(10);
      doc.setTextColor(80, 80, 80);
      
      const metrics = [
        `Total em Estoque: ${reportData.items.reduce((sum, item) => sum + item.qty, 0)} unidades`,
        `Pneus com Fogo: ${reportData.fogos.length}`,
        `Valor Total Estoque: R$ ${reportData.items.reduce((sum, item) => sum + (item.qty * (item.preco || 0)), 0).toLocaleString('pt-BR', {minimumFractionDigits: 2})}`,
        `Pneus Novos: ${reportData.items.filter(item => item.status === 'Novo').reduce((sum, item) => sum + item.qty, 0)}`
      ];
      
      metrics.forEach(metric => {
        if (yPosition > 270) {
          doc.addPage();
          yPosition = 20;
        }
        doc.text(`‚Ä¢ ${metric}`, 25, yPosition);
        yPosition += 7;
      });
    }

    function addComprehensiveContent(doc, yPosition) {
      // Conte√∫do do relat√≥rio completo
      doc.text('RELAT√ìRIO COMPLETO DO SISTEMA', 20, yPosition);
      // ... implementar conte√∫do detalhado
    }

    function addFinancialContent(doc, yPosition) {
      doc.text('AN√ÅLISE FINANCEIRA', 20, yPosition);
      // ... implementar conte√∫do financeiro
    }

    function addInventoryContent(doc, yPosition) {
      doc.text('RELAT√ìRIO DE ESTOQUE', 20, yPosition);
      // ... implementar conte√∫do de estoque
    }

    function generateDashboardExcelData() {
      return [
        ['RELAT√ìRIO DASHBOARD - TRANSPORTES CANARINHO'],
        ['Data de gera√ß√£o:', new Date().toLocaleDateString('pt-BR')],
        [],
        ['M√âTRICAS PRINCIPAIS', 'VALOR'],
        ['Total em Estoque', reportData.items.reduce((sum, item) => sum + item.qty, 0)],
        ['Pneus com Fogo', reportData.fogos.length],
        ['Valor Total Estoque', reportData.items.reduce((sum, item) => sum + (item.qty * (item.preco || 0)), 0)],
        ['Pneus Novos', reportData.items.filter(item => item.status === 'Novo').reduce((sum, item) => sum + item.qty, 0)]
      ];
    }

    function generateComprehensiveExcelData() {
      // Dados do relat√≥rio completo
      return [
        ['RELAT√ìRIO COMPLETO - TRANSPORTES CANARINHO'],
        // ... implementar dados completos
      ];
    }

    function generateFinancialExcelData() {
      // Dados financeiros
      return [
        ['RELAT√ìRIO FINANCEIRO - TRANSPORTES CANARINHO'],
        // ... implementar dados financeiros
      ];
    }

    function generateInventoryExcelData() {
      // Dados de estoque
      const header = ['ID', 'Medida', 'Marca', 'Modelo', 'Status', 'Quantidade', 'Container', 'Valor Unit√°rio', 'Valor Total', 'Data Entrada'];
      const data = reportData.items.map(item => [
        item.id,
        item.medida,
        item.marca,
        item.modelo,
        item.status,
        item.qty,
        item.container,
        item.preco || 0,
        (item.preco || 0) * item.qty,
        item.dataEntrada
      ]);
      
      return [
        ['RELAT√ìRIO DE ESTOQUE - TRANSPORTES CANARINHO'],
        ['Exportado em:', new Date().toLocaleDateString('pt-BR')],
        [],
        header,
        ...data
      ];
    }

    function generateSummaryContent(tipo, startDate, endDate) {
      const totalEstoque = reportData.items.reduce((sum, item) => sum + item.qty, 0);
      const totalFogos = reportData.fogos.length;
      const valorTotal = reportData.items.reduce((sum, item) => sum + (item.qty * (item.preco || 0)), 0);
      
      return `
        <div class="header">
          <h1>TRANSPORTES CANARINHO</h1>
          <h2>Relat√≥rio Resumido - ${getReportTitle(tipo)}</h2>
          <p>Per√≠odo: ${formatDate(startDate)} √† ${formatDate(endDate)}</p>
          <p>Gerado em: ${new Date().toLocaleDateString('pt-BR')}</p>
        </div>
        
        <div class="metric">
          <h3>üì¶ Estoque Total</h3>
          <p><strong>${totalEstoque}</strong> unidades</p>
        </div>
        
        <div class="metric">
          <h3>üî• Pneus com Fogo</h3>
          <p><strong>${totalFogos}</strong> fogos ativos</p>
        </div>
        
        <div class="metric">
          <h3>üí∞ Valor do Estoque</h3>
          <p><strong>R$ ${valorTotal.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</strong></p>
        </div>
        
        <h3>üìä Distribui√ß√£o por Status</h3>
        <table>
          <tr>
            <th>Status</th>
            <th>Quantidade</th>
            <th>Percentual</th>
          </tr>
          <tr>
            <td>Novo</td>
            <td>${reportData.items.filter(item => item.status === 'Novo').reduce((sum, item) => sum + item.qty, 0)}</td>
            <td>${((reportData.items.filter(item => item.status === 'Novo').reduce((sum, item) => sum + item.qty, 0) / totalEstoque) * 100).toFixed(1)}%</td>
          </tr>
          <tr>
            <td>Usado</td>
            <td>${reportData.items.filter(item => item.status === 'Usado').reduce((sum, item) => sum + item.qty, 0)}</td>
            <td>${((reportData.items.filter(item => item.status === 'Usado').reduce((sum, item) => sum + item.qty, 0) / totalEstoque) * 100).toFixed(1)}%</td>
          </tr>
          <tr>
            <td>Reformado</td>
            <td>${reportData.items.filter(item => item.status === 'Reformado').reduce((sum, item) => sum + item.qty, 0)}</td>
            <td>${((reportData.items.filter(item => item.status === 'Reformado').reduce((sum, item) => sum + item.qty, 0) / totalEstoque) * 100).toFixed(1)}%</td>
          </tr>
        </table>
      `;
    }

    // Fun√ß√µes de relat√≥rio espec√≠ficas para os cards de exporta√ß√£o
    function generateComprehensivePDF() {
      openReportModal('comprehensive');
    }

    function generateFinancialPDF() {
      openReportModal('financial');
    }

    function generateInventoryPDF() {
      openReportModal('inventory');
    }

    // ... Restante do c√≥digo JavaScript anterior ...
  </script>
</body>
</html>
